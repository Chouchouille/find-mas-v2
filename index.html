<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Rechercher MAS</title>
<style>
  :root {
    --number-size: 6px;
  }

  body {
    margin: 0;
    height: 100vh;
    overflow: hidden;
    background: black;
    font-family: Arial, sans-serif;
    touch-action: none;
  }

  /* === Intro === */
  #introScreen {
    position: fixed;
    inset: 0;
    background: radial-gradient(circle, #000000 0%, #200000 80%);
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 100;
    animation: fadeIn 1s ease-in-out;
    cursor: pointer;
  }

  #introScreen h1 {
    font-size: 2rem;
    color: red;
    text-shadow: 0 0 15px red;
  }

  #introScreen p {
    font-size: 1rem;
    color: white;
    margin-top: 10px;
  }

  .progress-container {
    position: relative;
    width: 220px;
    height: 12px;
    background: rgba(255, 255, 255, 0.15);
    border-radius: 6px;
    overflow: hidden;
    margin-top: 25px;
    box-shadow: 0 0 10px rgba(255,0,0,0.3);
  }

  .progress-bar {
    width: 0%;
    height: 100%;
    background: linear-gradient(90deg, #ff0000, #ff5050, #ff0000);
    background-size: 200% 100%;
    animation: progressMove 3s linear forwards, lightWave 1s linear infinite;
    border-radius: 6px;
  }

  @keyframes lightWave {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
  }

  @keyframes progressMove {
    from { width: 0%; }
    to { width: 100%; }
  }

  .progress-text {
    margin-top: 10px;
    font-size: 1rem;
    color: white;
    text-shadow: 0 0 10px red;
  }

  @keyframes fadeOut {
    from { opacity: 1; }
    to { opacity: 0; visibility: hidden; }
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  /* === Carte === */
  #zoomContainer {
    position: relative;
    width: 100%;
    height: 100%;
    transform-origin: center center;
    background-image: url('mas.jpg');
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
  }

  .number {
    position: absolute;
    color: white;
    background-color: rgba(185, 184, 184, 0.6);
    padding: 1px 2px;
    border-radius: 2px;
    transform: translate(-50%, -50%);
    font-size: var(--number-size);
    transition: background 0.2s, color 0.2s, font-size 0.2s;
  }

  .number:hover {
    background: rgba(255,255,255,0.7);
  }

  .number.found {
    background: red !important;
    color: white !important;
    font-weight: bold;
    animation: blink 1s ease-in-out 2;
  }

  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
  }

  .search-box, .password-box, .size-box {
    position: fixed;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.6);
    color: white;
    border: 2px solid red;
    border-radius: 20px;
    padding: 10px;
    display: flex;
    gap: 5px;
    z-index: 10;
    align-items: center;
  }

  .search-box { top: 15px; }
  .password-box { top: 70px; }
  .size-box { top: 125px; display: none; }

  .search-box button, .password-box button {
    border-radius: 10px;
    background: red;
    color: white;
    border: none;
    padding: 5px 10px;
    cursor: pointer;
  }

  input[type="range"] {
    accent-color: red;
  }

  .image-container {
    position: fixed;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    width: 100px;
    height: 100px;
    display: none;
    background: rgba(0,0,0,0.7);
    border-radius: 10px;
    border: 2px solid red;
    z-index: 20;
  }

  .image-container.show { display: block; }
  .image-container img { width:100%; height:100%; object-fit:contain; }
</style>
</head>
<body>

<!-- === INTRO === -->
<div id="introScreen" onclick="hideIntro()">
  <h1>Bienvenue Xavier</h1>
  <p>Chargement en cours...</p>
  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>
  <div class="progress-text" id="progressText">0%</div>
</div>

<!-- === Barre de recherche === -->
<div class="search-box">
  <input type="text" id="searchInput" placeholder="Rechercher un num√©ro">
  <button onclick="searchNumber()">Rechercher</button>
  <button id="resetButton" onclick="resetNumbers()" style="background:darkred; display:none;">üóëÔ∏è Effacer tout</button>
</div>

<!-- === Mot de passe === -->
<div class="password-box">
  <input type="password" id="passwordInput" placeholder="Mot de passe">
  <button onclick="validatePassword()">Valider</button>
</div>

<!-- === Curseur de taille === -->
<div class="size-box" id="sizeBox">
  <label for="sizeRange">Taille :</label>
  <input type="range" id="sizeRange" min="0" max="50" step="1">
  <span id="sizeValue"></span>
</div>

<!-- === Image d'affichage === -->
<div class="image-container" id="imageContainer">
  <img id="imageDisplay">
</div>

<!-- === Zone zoomable === -->
<div id="zoomContainer"></div>

<script>
/* === Barre de chargement === */
const progressText = document.getElementById("progressText");
let progress = 0;
const interval = setInterval(() => {
  if (progress < 100) {
    progress += 2;
    progressText.textContent = progress + "%";
  } else {
    progressText.textContent = "Pr√™t !";
    clearInterval(interval);
  }
}, 60);

function hideIntro() {
  const intro = document.getElementById("introScreen");
  intro.style.animation = "fadeOut 1s forwards";
  setTimeout(() => intro.remove(), 1000);
}

window.addEventListener("load", () => {
  setTimeout(hideIntro, 3200);
});

/* === Gestion de la taille === */
const sizeBox = document.getElementById("sizeBox");
const sizeRange = document.getElementById("sizeRange");
const sizeValue = document.getElementById("sizeValue");

const savedSize = localStorage.getItem("numberSize") || 18;
document.documentElement.style.setProperty("--number-size", savedSize + "px");
sizeRange.value = savedSize;
sizeValue.textContent = savedSize + "px";

sizeRange.addEventListener("input", () => {
  const val = sizeRange.value;
  document.documentElement.style.setProperty("--number-size", val + "px");
  sizeValue.textContent = val + "px";
  localStorage.setItem("numberSize", val);
});

/* === Mot de passe === */
const correctPassword = "17061977";
let isPasswordValid = false;

function validatePassword() {
  const input = document.getElementById("passwordInput").value;
  if (input === correctPassword) {
    alert("Mot de passe correct ‚úÖ");
    isPasswordValid = true;
    document.getElementById("resetButton").style.display = "inline-block";
    sizeBox.style.display = "flex"; // üî• le curseur devient visible ici
  } else {
    alert("Mot de passe incorrect ‚ùå");
  }
}

/* === Fonctions de base de la carte === */
const zoomContainer = document.getElementById("zoomContainer");
const numbers = JSON.parse(localStorage.getItem("numbers")) || {};

function createNumberElement(number, xPercent, yPercent) {
  const el = document.createElement("div");
  el.classList.add("number");
  el.textContent = number;
  el.style.left = `${xPercent}%`;
  el.style.top = `${yPercent}%`;
  zoomContainer.appendChild(el);
}

for (const n in numbers) createNumberElement(n, numbers[n].xPercent, numbers[n].yPercent);

zoomContainer.addEventListener("click", (e) => {
  if (!isPasswordValid) return;
  const rect = zoomContainer.getBoundingClientRect();
  const xPercent = ((e.clientX - rect.left) / rect.width) * 100;
  const yPercent = ((e.clientY - rect.top) / rect.height) * 100;
  const num = prompt("Entrez un num√©ro :");
  if (num && !isNaN(num)) {
    numbers[num] = { xPercent, yPercent };
    localStorage.setItem("numbers", JSON.stringify(numbers));
    createNumberElement(num, xPercent, yPercent);
  }
});

function resetNumbers() {
  if (!isPasswordValid) return alert("Acc√®s refus√© ‚ùå");
  if (confirm("Supprimer tous les num√©ros ?")) {
    localStorage.removeItem("numbers");
    document.querySelectorAll(".number").forEach(el => el.remove());
  }
}
</script>
</body>
</html>






